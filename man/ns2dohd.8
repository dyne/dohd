.TH NS2DOHD 8 "February 2026" "dohd 0.8" "System Manager's Manual"
.SH NAME
\fBns2dohd\fR \- local DNS to DNS-over-HTTPS forwarding daemon
.SH SYNOPSIS
.B ns2dohd
\-d
.I doh_url
[
.B \-p
.I port
] [
.B \-u
.I user
] [
.B \-r
.I resolver_ip
] [
.B \-O
] [
.B \-\-odoh-proxy
.I proxy_url
] [
.B \-\-odoh-config
.I config_file
] [
.B \-A
.I cafile
] [
.B \-F
] [
.B \-v
] [
.B \-V
] [
.B \-h
]
.SH DESCRIPTION
.B ns2dohd
listens on local UDP DNS (default 127.0.0.1:53), receives classic DNS requests from the host, and forwards them to a DoH endpoint over HTTP/2 using wolfSSL and nghttp2.
.PP
To avoid resolver recursion when the local host itself uses 127.0.0.1 as nameserver,
.B ns2dohd
uses a separate bootstrap DNS resolver (default 1.1.1.1) to resolve the DoH endpoint hostname.
.SH OPTIONS
.TP
.BI \-d " doh_url"
DoH endpoint URL (https://...). Mandatory.
.TP
.BI \-p " port"
Local UDP listen port. Default: 53.
.TP
.BI \-u " user"
Drop privileges to this user after binding sockets (when started as root).
.TP
.BI \-r " resolver_ip"
Bootstrap DNS resolver IP used for resolving the DoH endpoint host. Default: 1.1.1.1.
.TP
.BI \-A " cafile"
CA bundle file in PEM format.
.TP
.B \-O
Enable ODoH client mode.
.TP
.BI \-\-odoh-proxy " proxy_url"
ODoH proxy URL used in ODoH mode.
.TP
.BI \-\-odoh-config " config_file"
Binary ObliviousDoHConfigs file for target public key config.
.IP
In ODoH mode, the target resolver from
.B \-d
is automatically encoded as
.B targethost
and
.B targetpath
query parameters for the proxy.
.TP
.B \-F
Run in foreground (do not daemonize).
.TP
.B \-v
Verbose logging.
.TP
.B \-V
Print version and exit.
.TP
.B \-h
Print help and exit.
.SH ODOH DEPLOYMENT NOTE
When using ODoH mode, production privacy requires independent proxy and target
operators as described by RFC 9230. Local or same-organization proxy+target
deployments are for protocol evaluation only.
.PP
Without separation, proxy-observed client metadata can be correlated with
target-decrypted DNS contents.
.SH EXAMPLES
Run as local DNS daemon and drop privileges to user \fB_dohd\fR:
.PP
.nf
 ns2dohd -d https://dns.dyne.org/dns-query -u _dohd
.fi
.PP
Use a custom bootstrap resolver:
.PP
.nf
 ns2dohd -d https://dns.dyne.org/dns-query -r 9.9.9.9 -u _dohd
.fi
.SH SEE ALSO
.BR dohd (8),
.BR dohproxyd (8),
.BR odoh-keygen (1)
.SH LICENSE
GNU AGPLv3.
